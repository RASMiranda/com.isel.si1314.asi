venda de produtos de vestuário
	um conjuntos de lojas de produtos para criança e senhora 
	um conjuntos de lojas de produtos para homem e desportistas
Cada conjunto de lojas tem o seu próprio servidor aplicacional e SGBD.
Cada loja tem um ou vários computadores pessoais que 
	executam a lógica de apresentação.

» 2 instancias de BD's?
» servidores aplicacionais WCF nos 2 locais? (nao ha IIS)

O stock físico, existe nos armazéns da empresa.
As encomendas firmadas pelos clientes são expedidas para a morada dos mesmos. 


A empresa também possui uma sede q tb tem o seu próprio servidor aplicacional e SGBD.

» +1 instancia de BD's?
» +1 servidores aplicacionais WCF?

Aqui são realizados:
	os procedimentos de gestão comuns aos dois conjuntos de lojas, tais como 
		encomendas a fornecedores,
		» proc sp_realizarEncomendas
		inserção de novos produtos e 
		» proc sp_inserirProduto e sp_removerProduto
		recepção de encomendas de fornecedores.
		» proc sp_receberEncomenda


Um 'produto' consiste em 
	um código, 
	um tipo, 
	uma designação, 
	um preço, 
	a quantidade disponível em stock, 
	a quantidade mínima de stock e 
	a indicação do respectivo fornecedor. 


Nas lojas apenas é relevante a informação relativa 
	ao código e
	quantidade disponível em stock.
» CREATE TABLE [dbo].[produto](
	[cod] [int] NOT NULL,
	[preco] [money] NULL,
	[qtStock] [int] NULL,
	[qtMinStock] [int] NULL   «««««««« mover para a sede!
)

Na sede é relevante a informação sobre 
	código, 
	quantidade mínima de stock e 
	fornecedor. 
» CREATE TABLE [dbo].[produto](
	[codFornecedor] [int] NULL,
	[qtEncomenda] [int] NULL,
	[cod] [int] NOT NULL,
	[estado] [bit] NULL,		«««««««« n faz parte do enunciado mas faz falta para gerir as encomendas. significa 'encomenda pendente?'
	[tipo] [char](1) NOT NULL
)

» falta a coluna designação (sede ou loja?)


Um 'fornecedor' consiste em
	número de fornecedor, 
	o nome e 
	a morada, 
esta informação é relevante apenas na sede.
» CREATE TABLE [dbo].[fornecedor](
	[cod] [int] NOT NULL,
	[nome] [varchar](20) NULL,
	[morada] [varchar](60) NULL
)


As lojas realizam vendas de produtos e, nestes processos, 
	apenas dependem do servidor aplicacional e SGBD do respectivo conjunto de lojas, 
	» ok, a info necessaria à realizacao de uma venda ja se encontra na loja. As vendas geradas sao registadas na loja e enviadas à sede via queue?
	devendo funcionar com total autonomia, relativamente à sede e ao outro conjunto de lojas.
	» uma queue trataria deste requisito. autonomia entre lojas é non-issue; a queue não resolve nenhum problema entre lojas;


Pretende-se, no entanto, que a informação das vendas seja transmitida à sede, 
	para que esta possa expedir as encomendas para os clientes e 
	» TODO: nocao de cliente e expedicao de encomendas para o mesmo nao está implementada
	realizar as encomendas aos fornecedores, se for o caso.
	» proc sp_realizarEncomendas & proc sp_receberEncomenda. Acho que por "se for o caso" o Eng entende "se hover motivo para isso". A flag de estado serve precisamente para não fazer encomendas umas atrás das outras se já houver uma encomenda pendente.


Quando a sede recebe produtos dos fornecedores, deve 
	actualizar os stocks no SGBD do conjunto de lojas adequado, de forma síncrona.
	» o proc receberProduto actualiza uma view sobre db links. Penso que esta actualização é realizada síncrona entre as várias DB's.

A sede também realiza encomendas a fornecedores, de forma autónoma. 
	» OK, o conceito de fornecedor é exclusivo à sede


Na sede são também 
	inseridos novos produtos e 
	» proc sp_inserirProduto
	inseridos novos fornecedores e 
	» TODO: actualmente os fornecedores são adicionados via SQL Insert; pode criar-se um servico que adiciona novos fornecedores via EA
	realizadas listagens do estado dos produtos (quantidade em stock).
	» a view vw_verificarStock serve para isto


============ // ============ // ============ // ============ // ============ // ============ // ============ // ============ // ============


1. Proposta de uma arquitectura que permita a utilização de 
	-transacções locais, de 
	-transacções declarativas em WCF, de 
		»»» não estou a ver uma situação - segundo o enunciado - onde as transacções declarativas fossem uteis... têm alguma ideia? já pensei em pedir uma sujestão ao Eng...
	-filas de mensagens e,
		»»» para a transmissao de vendas das lojas para a sede
	-se achar justificável, transacções distribuídas controladas pelo SGBD.
		»»» o proc receberProduto inicia uma transacção distribuídas pelas 3 instancias de SGBD


2. O modelo de dados, e os esquemas de fragmentação e distribuição (incluindo replicação) para a parte obrigatória.
	»»» vocês sabem dizer-me que informação é relevante nas 3 instancias?
	até agora apenas a info sobre Produto aparenta ser necessaria nas 3 instancias, e mesmo essa é só a info de algumas colunas.


3. Os 'scripts' SQL que permitem criar as bases de dados utilizadas, incluindo possíveis vistas, procedimentos armazenados e gatilhos, para a parte obrigatória.
	TODO: Em execução...


4. A construção da lógica aplicacional nos três servidores aplicacionais.
	»»» aplicações .net: web services disponibilizados através de WCF presumo eu?
	TODO: Em execução...


5. (Opcional) As alterações necessárias para contemplar a parte opcional 1. 
1. Pretende-se que cada loja possa inserir informação sobre reclamações dos clientes.
Cada reclamação tem um 
	identificador gerado automaticamente, 
	o nº do bilhete de identidade do cliente, 
	um texto e 
	a data de inserção. 
Esta informação deve ser passada de forma assíncrona para os restantes SGBDs. Implemente esta funcionalidade.
	»»» acho que esta alinea é implementada com uma simples replicação assincrona
		e adicao da tabela de cliente... :\


6. (Opcional) As alterações necessárias para contemplar a parte opcional 2. 
2. As vendas nas lojas de produtos para senhora e criança aumentaram muito, tendo o sistema ficado demasiado lento. Constatou-se que tal é devido ao mau desempenho do SGBD respectivo nas operações de actualização. Proponha e implemente uma solução para este problema
	»»» suponho que aqui seja para usar sharding, no entanto nao tenho certeza.


7. Sabendo que os serviços de vendas devem funcionar com elevada disponibilidade, discuta possíveis soluções para o conseguir, incluído nessa discussão a relação custo/possibilidade de perda de informação.
	»»» acho que convem confirmar junto do Eng que nesta alínea não temos que implementar nada; para garantir que é só discussão em termos de relatório;


8. Sabendo que na sede se deve garantir robustez contra possíveis desastres, podendo, no entanto, tolerar-se falhas no funcionamento de algumas horas, discuta possíveis soluções para garantir essa robustez, incluindo nessa discussão a relação desempenho/possibilidade de perda de informação.
	»»» aqui penso que tb convem confirmar junto do Eng que não é preciso *implementar* um esquema de replicação;
